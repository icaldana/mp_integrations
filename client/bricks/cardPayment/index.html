<!DOCTYPE html>
<html>

<head>
    <script src="https://sdk.mercadopago.com/js/v2"></script>
</head>

<body>
    <script>
        const mp = new MercadoPago("TEST-de563cac-2acb-4ec6-b506-9fb302a2848d");
        const bricksBuilder = mp.bricks();

        const renderCardPaymentBrick = async (bricksBuilder) => {
            const settings = {
                initialization: {
                    amount: 100,
                },
                callbacks: {
                    onReady: () => console.log("Brick ready!"),
                    onSubmit: (formData) => {
                        return new Promise((resolve, reject) => {
                            fetch("http://localhost:8000/process_payment", {
                                method: "POST",
                                headers: {
                                    "Content-Type": "application/json",
                                },
                                body: JSON.stringify(formData),
                            })
                                .then((response) => response.json())
                                .then((response) => {
                                    console.log("Response: ", response);
                                    resolve();
                                })
                                .catch((error) => {
                                    console.log("Error: ", error)
                                    reject();
                                });
                        });
                    },
                    onError: (error) => console.error(error),
                },
            };
            window.cardPaymentBrickController = await bricksBuilder.create(
                "cardPayment",
                "cardPaymentBrick_container",
                settings
            );
        };
        renderCardPaymentBrick(bricksBuilder);
    </script>
    <div id="cardPaymentBrick_container"></div>
</body>

</html>